---
export const prerender = true;

import { ViewTransitions } from "astro:transitions";
import "@fontsource/montserrat";

import "~/styles/global.css";

declare global {
  interface Window {
    posthog: any; // Add this line for postHog
    Intercom: any; // Existing declaration
    intercomSettings: {
      // Adding the intercomSettings property
      api_base: string;
      app_id: string;
      name?: string;
      user_id?: string;
      email?: string;
      created_at?: number;
    };
  }
}
interface Props {
  title?: string;
  description?: string;
  image?: string;
}

import PostHog from "~/components/posthog.astro";
import ProfileButton from "~/components/ProfileButton";
import NotificationContainer from "~/components/Notifications/NotificationContainer";
---

<html lang='en'>
  <head>
    <meta charset='utf-8' />
    <meta
      name='description'
      content={Astro.props.description ||
        "Lightup – a community where your involvement accelerates scientific progress and global betterment. Contribute to impactful research and be the catalyst for change."}
    />
    <meta name='viewport' content='width=device-width' />
    <link rel='icon' type='image/svg+xml' href='/favicon.svg' />
    <meta
      property='og:title'
      content={Astro.props.title ??
        "Lightup: Fueling Scientific Breakthroughs for a Better World"}
    />
    <meta
      property='og:description'
      content={Astro.props.description ||
        "Lightup – a community where your involvement accelerates scientific progress and global betterment. Contribute to impactful research and be the catalyst for change."}
    />
    <meta
      property='og:image'
      content={Astro.props.image ||
        "https://imagedelivery.net/xHZxKHrwCcaO8iTco-Njhg/9e71f1d7-427a-4e7a-85fa-dcd7234db700/ogImage"}
    />
    <meta name='generator' content={Astro.generator} />
    <title>
      {
        Astro.props.title ??
          "Lightup: Fueling Scientific Breakthroughs for a Better World"
      }
    </title>
    <ViewTransitions />
    <PostHog />
    <script defer src='https://js.stripe.com/v3/'></script>
    <script>
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "t6yyzmj6",
        // name: user.name, // Full name
        // user_id: user.id, // a UUID for your user
        // email: user.email, // the email for your user
        // created_at: user.createdAt, // Signup date as a Unix timestamp
      };
    </script>

    <script defer>
      // We pre-filled your app ID in the widget URL: 'https://widget.intercom.io/widget/t6yyzmj6'
      (function () {
        var w = window;
        var ic = w.Intercom;
        if (typeof ic === "function") {
          ic("reattach_activator");
          ic("update", w.intercomSettings);
        } else {
          var d = document;
          var i = function () {
            i.c(arguments);
          };
          i.q = [];
          i.c = function (args) {
            i.q.push(args);
          };
          w.Intercom = i;
          var l = function () {
            var s = d.createElement("script");
            s.type = "text/javascript";
            s.async = true;
            s.src = "https://widget.intercom.io/widget/t6yyzmj6";
            var x = d.getElementsByTagName("script")[0];
            x.parentNode.insertBefore(s, x);
          };
          if (document.readyState === "complete") {
            l();
          } else if (w.attachEvent) {
            w.attachEvent("onload", l);
          } else {
            w.addEventListener("load", l, false);
          }
        }
      })();
    </script>
    <link rel='sitemap' href='/sitemap-index.xml' />
  </head>
  <body>
    <header>
      <nav class='flex justify-between flex-nowrap p-4 mx-auto max-w-6xl z-50'>
        <a href='/' aria-label='Lightup' data-astro-prefetch>
          <h1 class='text-start text-4xl font-black text-brand_yellow'>
            Lightup
          </h1>
        </a>
        <a href='/profile' aria-label='profile' data-astro-prefetch>
          <ProfileButton client:only='solid-js' />
        </a>
      </nav>
      <NotificationContainer client:only='solid-js' />
    </header>
    <main>
      <slot />
    </main>
  </body>
</html>
